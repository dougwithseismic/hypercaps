{"version":3,"file":"preload.js","sources":["../../electron/preload.ts"],"sourcesContent":["import { contextBridge, ipcRenderer } from \"electron\";\r\nimport { AppState } from \"./services/store/types/app-state\";\r\nimport { HyperKeyFeatureConfig } from \"./features/hyperkeys/types/hyperkey-feature\";\r\nimport type { IPCCommand } from \"./services/ipc/types\";\r\n\r\n// Expose protected methods that allow the renderer process to use\r\n// the ipcRenderer without exposing the entire object\r\ncontextBridge.exposeInMainWorld(\"api\", {\r\n  // Window controls\r\n  minimizeWindow: () => {\r\n    ipcRenderer.send(\"minimize-window\");\r\n  },\r\n  closeWindow: () => {\r\n    ipcRenderer.send(\"close-window\");\r\n  },\r\n\r\n  // Custom IPC Bridge\r\n  ipc: {\r\n    // Command handling\r\n    run: async <TParams = unknown, TResult = unknown>(\r\n      command: IPCCommand<TParams>\r\n    ): Promise<TResult> => {\r\n      console.log(\"[Preload] Running command:\", command);\r\n      const result = await ipcRenderer.invoke(\"ipc:command\", command);\r\n      console.log(\"[Preload] Command result:\", result);\r\n      return result as TResult;\r\n    },\r\n\r\n    // Event handling\r\n    on: <TData = unknown>(\r\n      service: string,\r\n      event: string,\r\n      callback: (data: TData) => void\r\n    ) => {\r\n      console.log(\"[Preload] Setting up event listener:\", service, event);\r\n      const handler = (\r\n        _: unknown,\r\n        ipcEvent: { service: string; event: string; data: TData }\r\n      ) => {\r\n        console.log(\"[Preload] Received event:\", ipcEvent);\r\n        if (ipcEvent.service === service && ipcEvent.event === event) {\r\n          console.log(\"[Preload] Event matched, calling callback\");\r\n          callback(ipcEvent.data);\r\n        }\r\n      };\r\n      ipcRenderer.on(\"ipc:event\", handler);\r\n      return () => {\r\n        console.log(\"[Preload] Removing event listener:\", service, event);\r\n        ipcRenderer.removeListener(\"ipc:event\", handler);\r\n      };\r\n    },\r\n  },\r\n\r\n  // HyperKey feature\r\n  getHyperKeyConfig: async () => {\r\n    return ipcRenderer.invoke(\"get-hyperkey-config\");\r\n  },\r\n  setHyperKeyConfig: async (config: HyperKeyFeatureConfig) => {\r\n    return ipcRenderer.invoke(\"set-hyperkey-config\", config);\r\n  },\r\n\r\n  // App settings\r\n  getStartupSettings: async () => {\r\n    return ipcRenderer.invoke(\"get-startup-settings\");\r\n  },\r\n  setStartupOnBoot: async (enabled: boolean) => {\r\n    return ipcRenderer.invoke(\"set-startup-on-boot\", enabled);\r\n  },\r\n  setStartMinimized: async (enabled: boolean) => {\r\n    return ipcRenderer.invoke(\"set-start-minimized\", enabled);\r\n  },\r\n\r\n  // Store state\r\n  getFullState: async () => {\r\n    return ipcRenderer.invoke(\"get-full-state\") as Promise<AppState>;\r\n  },\r\n});\r\n"],"names":["contextBridge","ipcRenderer"],"mappings":";;AAOAA,SAAAA,cAAc,kBAAkB,OAAO;AAAA;AAAA,EAErC,gBAAgB,MAAM;AACpBC,aAAA,YAAY,KAAK,iBAAiB;AAAA,EACpC;AAAA,EACA,aAAa,MAAM;AACjBA,aAAA,YAAY,KAAK,cAAc;AAAA,EACjC;AAAA;AAAA,EAGA,KAAK;AAAA;AAAA,IAEH,KAAK,OACH,YACqB;AACb,cAAA,IAAI,8BAA8B,OAAO;AACjD,YAAM,SAAS,MAAMA,SAAAA,YAAY,OAAO,eAAe,OAAO;AACtD,cAAA,IAAI,6BAA6B,MAAM;AACxC,aAAA;AAAA,IACT;AAAA;AAAA,IAGA,IAAI,CACF,SACA,OACA,aACG;AACK,cAAA,IAAI,wCAAwC,SAAS,KAAK;AAC5D,YAAA,UAAU,CACd,GACA,aACG;AACK,gBAAA,IAAI,6BAA6B,QAAQ;AACjD,YAAI,SAAS,YAAY,WAAW,SAAS,UAAU,OAAO;AAC5D,kBAAQ,IAAI,2CAA2C;AACvD,mBAAS,SAAS,IAAI;AAAA,QAAA;AAAA,MAE1B;AACYA,2BAAA,GAAG,aAAa,OAAO;AACnC,aAAO,MAAM;AACH,gBAAA,IAAI,sCAAsC,SAAS,KAAK;AACpDA,6BAAA,eAAe,aAAa,OAAO;AAAA,MACjD;AAAA,IAAA;AAAA,EAEJ;AAAA;AAAA,EAGA,mBAAmB,YAAY;AACtB,WAAAA,SAAA,YAAY,OAAO,qBAAqB;AAAA,EACjD;AAAA,EACA,mBAAmB,OAAO,WAAkC;AACnD,WAAAA,qBAAY,OAAO,uBAAuB,MAAM;AAAA,EACzD;AAAA;AAAA,EAGA,oBAAoB,YAAY;AACvB,WAAAA,SAAA,YAAY,OAAO,sBAAsB;AAAA,EAClD;AAAA,EACA,kBAAkB,OAAO,YAAqB;AACrC,WAAAA,qBAAY,OAAO,uBAAuB,OAAO;AAAA,EAC1D;AAAA,EACA,mBAAmB,OAAO,YAAqB;AACtC,WAAAA,qBAAY,OAAO,uBAAuB,OAAO;AAAA,EAC1D;AAAA;AAAA,EAGA,cAAc,YAAY;AACjB,WAAAA,SAAA,YAAY,OAAO,gBAAgB;AAAA,EAAA;AAE9C,CAAC;"}